{
  "id": "case-01",
  "number": 1,
  "title": "O Ponto √önico de Falha",
  "subtitle": "Registros criminais ficam inacess√≠veis em todas as delegacias",
  "brief": {
    "narrative": "S√£o 2 da manh√£ e a central est√° inundada de chamados. Todas as delegacias de Distributia reportam o mesmo problema: os policiais n√£o conseguem consultar registros criminais. Sem antecedentes, sem mandados, sem casos pendentes. O Banco de Dados Central de Registros Criminais ‚Äî o √∫nico ‚Äî acabou de sair do ar. Um policial parou um suspeito com 3 mandados pendentes e teve que liber√°-lo porque o sistema n√£o mostrava nada. O Chefe Partition quer respostas, Detetive.",
    "symptoms": [
      "Todas as 3 delegacias reportam perda total de acesso aos registros criminais",
      "O servidor central do banco de dados apresenta alerta de falha de hardware",
      "Nenhum sistema de backup est√° respondendo",
      "Policiais em campo n√£o conseguem verificar mandados ou antecedentes"
    ],
    "objective": "Identificar por que a falha de um √∫nico servidor derrubou todo o sistema de registros e recomendar uma solu√ß√£o para evitar que isso aconte√ßa novamente."
  },
  "diagram": {
    "nodes": [
      {
        "id": "db-central",
        "type": "database",
        "label": "Central Records DB",
        "status": "failed",
        "position": { "x": 350, "y": 50 },
        "inspectable": true,
        "inspectData": {
          "title": "Banco de Dados Central de Registros",
          "logs": [
            "[02:01:33] WARN: Disk I/O latency exceeding thresholds",
            "[02:01:47] ERROR: Disk failure detected on /dev/sda1",
            "[02:01:48] FATAL: Unable to read data files",
            "[02:01:48] FATAL: Database process terminated",
            "[02:01:49] INFO: No failover configured"
          ],
          "data": {
            "Status": "OFFLINE",
            "Uptime": "0s (crashed)",
            "Records": "2.4M records (inaccessible)",
            "Replicas": "None configured",
            "Last Backup": "72 hours ago"
          },
          "status": "Falha de hardware ‚Äî disco danificado. Nenhuma replica√ß√£o ou failover configurado."
        }
      },
      {
        "id": "precinct-north",
        "type": "client",
        "label": "North Precinct",
        "status": "failed",
        "position": { "x": 100, "y": 280 },
        "inspectable": true,
        "inspectData": {
          "title": "Terminal da Delegacia Norte",
          "logs": [
            "[02:02:01] ERROR: Connection to records DB refused",
            "[02:02:01] ERROR: Query timeout after 5000ms",
            "[02:02:15] WARN: All record lookups failing"
          ],
          "data": {
            "Status": "NO DATABASE CONNECTION",
            "Pending Queries": "47",
            "Officers Active": "12"
          },
          "status": "N√£o consegue conectar ao banco de dados central. Nenhum fallback dispon√≠vel."
        }
      },
      {
        "id": "precinct-south",
        "type": "client",
        "label": "South Precinct",
        "status": "failed",
        "position": { "x": 350, "y": 280 },
        "inspectable": true,
        "inspectData": {
          "title": "Terminal da Delegacia Sul",
          "logs": [
            "[02:02:03] ERROR: Connection to records DB refused",
            "[02:02:04] ERROR: Query timeout after 5000ms"
          ],
          "data": {
            "Status": "NO DATABASE CONNECTION",
            "Pending Queries": "23",
            "Officers Active": "8"
          },
          "status": "N√£o consegue conectar ao banco de dados central. Nenhum fallback dispon√≠vel."
        }
      },
      {
        "id": "precinct-east",
        "type": "client",
        "label": "East Precinct",
        "status": "failed",
        "position": { "x": 600, "y": 280 },
        "inspectable": true,
        "inspectData": {
          "title": "Terminal da Delegacia Leste",
          "logs": [
            "[02:02:05] ERROR: Connection to records DB refused",
            "[02:02:06] ERROR: Query timeout after 5000ms"
          ],
          "data": {
            "Status": "NO DATABASE CONNECTION",
            "Pending Queries": "31",
            "Officers Active": "10"
          },
          "status": "N√£o consegue conectar ao banco de dados central. Nenhum fallback dispon√≠vel."
        }
      }
    ],
    "edges": [
      { "id": "e-db-north", "source": "db-central", "target": "precinct-north", "label": "queries", "animated": false, "style": "broken" },
      { "id": "e-db-south", "source": "db-central", "target": "precinct-south", "label": "queries", "animated": false, "style": "broken" },
      { "id": "e-db-east", "source": "db-central", "target": "precinct-east", "label": "queries", "animated": false, "style": "broken" }
    ]
  },
  "diagnosis": {
    "rootCause": {
      "question": "Qual √© a causa raiz da indisponibilidade em todo o sistema?",
      "options": [
        {
          "id": "rc-1",
          "text": "Uma parti√ß√£o de rede est√° impedindo as delegacias de acessar o banco de dados",
          "correct": false,
          "feedback": "N√£o √© isso. Os logs do banco de dados mostram uma falha de disco (hardware), n√£o um problema de rede. Todas as delegacias sofrem o mesmo problema porque todas dependem do mesmo servidor √∫nico."
        },
        {
          "id": "rc-2",
          "text": "O servidor √∫nico de banco de dados √© um ponto √∫nico de falha ‚Äî quando ele caiu, n√£o havia r√©plica para atender as requisi√ß√µes",
          "correct": true,
          "feedback": "Correto! Todo o sistema depende de um √∫nico servidor de banco de dados sem r√©plicas. Quando o disco desse servidor falhou, todas as delegacias perderam o acesso. Este √© o cl√°ssico problema de Ponto √önico de Falha (SPOF)."
        },
        {
          "id": "rc-3",
          "text": "O banco de dados ficou sem espa√ßo de armazenamento devido ao excesso de registros",
          "correct": false,
          "feedback": "Os logs mostram uma falha f√≠sica de disco (crash de hardware), n√£o um problema de capacidade de armazenamento. Mas mesmo que fosse um problema de espa√ßo, a verdadeira quest√£o arquitetural √© que existe apenas um servidor."
        },
        {
          "id": "rc-4",
          "text": "Consultas simult√¢neas demais das delegacias sobrecarregaram o banco de dados",
          "correct": false,
          "feedback": "Os logs mostram uma falha de hardware no disco, n√£o sobrecarga de desempenho. As consultas est√£o falhando porque o servidor est√° fora do ar, n√£o porque est√° sobrecarregado."
        }
      ]
    },
    "fix": {
      "question": "Qual √© a melhor solu√ß√£o para evitar que isso aconte√ßa novamente?",
      "options": [
        {
          "id": "fix-1",
          "text": "Adicionar replica√ß√£o de banco de dados ‚Äî manter pelo menos uma r√©plica que possa assumir caso o prim√°rio falhe",
          "correct": true,
          "feedback": "Correto! A replica√ß√£o de banco de dados cria c√≥pias dos dados em servidores separados. Se o prim√°rio (l√≠der) falhar, uma r√©plica (seguidor) pode ser promovida para atender as requisi√ß√µes. Isso elimina o ponto √∫nico de falha."
        },
        {
          "id": "fix-2",
          "text": "Aumentar a frequ√™ncia de backup de 72 horas para 1 hora",
          "correct": false,
          "feedback": "Backups mais frequentes ajudam na recupera√ß√£o de dados, mas n√£o resolvem o problema de disponibilidade. Restaurar um backup leva tempo ‚Äî voc√™ precisa de uma r√©plica ativa que possa assumir imediatamente."
        },
        {
          "id": "fix-3",
          "text": "Dar a cada delegacia sua pr√≥pria c√≥pia completa do banco de dados que funcione offline",
          "correct": false,
          "feedback": "Embora isso elimine o ponto √∫nico de falha, manter c√≥pias independentes completas em cada delegacia cria um pesadelo de consist√™ncia de dados. Como manter todas as c√≥pias sincronizadas? Replica√ß√£o com configura√ß√£o l√≠der-seguidor √© a abordagem padr√£o."
        },
        {
          "id": "fix-4",
          "text": "Instalar um disco melhor com redund√¢ncia RAID no servidor atual",
          "correct": false,
          "feedback": "RAID protege contra falha de disco em uma m√°quina, mas n√£o ajuda se o servidor inteiro cair (energia, placa-m√£e, etc.). Redund√¢ncia real requer m√°quinas separadas ‚Äî √© isso que a replica√ß√£o oferece."
        }
      ]
    }
  },
  "conceptId": "replication-basics",
  "badge": {
    "name": "Novato em Redund√¢ncia",
    "icon": "üõ°Ô∏è"
  }
}
